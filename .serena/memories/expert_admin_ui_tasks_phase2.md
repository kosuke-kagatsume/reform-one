# エキスパートコース管理者 UI修正タスク一覧（Phase 2）

作成日: 2026-01-07
**最終更新: 2026-02-06 - 全148タスク完了**

## 完了状況

| カテゴリ | 状態 | 完了日 |
|----------|------|--------|
| D. 左ナビ再構成 (5) | ✅ 完了 | 2026-02 |
| E. プラン別表示制御 (4) | ✅ 完了 | 2026-02 |
| 画面別改善 1-14 (120) | ✅ 完了 | 既存実装 |
| A. 通知システム (7) | ✅ 完了 | 既存実装 |
| B. リマインドメール (6) | ✅ 完了 | 2026-02 |
| C. Stripe連携 (6) | ✅ 完了 | 2026-02 |

**148/148タスク完了**

---
対象: Reform One プレミア購読 エキスパートコース管理者画面

---

## 仕様確定事項

### 基本仕様
| 項目 | 仕様 |
|------|------|
| データブックDL制限 | 契約期間中（開始〜更新日）に発行されたもののみ |
| 資格無料枠リセット | 契約更新日（組織ごと） |
| センリョク連携 | 自動メール送信（組織名/申込者名/人数）、アドレスは後で設定 |
| 決済サービス | Stripe |
| 視察会決済 | 事前決済（基本）＋当日支払いも対応 |

### コンテンツ
| 項目 | 仕様 |
|------|------|
| コミュニティ | 施工管理、人事・採用（月1回Zoomウェビナー） |
| 動画 | YouTube限定公開、URL/IDで登録 |
| データブック | PDFアップロード（表紙画像も） |
| ニュースレター | PDF形式 |
| ツール | 今後登録 |

### 通知・メール
| 項目 | 仕様 |
|------|------|
| 通知種類 | セミナー/アーカイブ/データブック/ニュースレター/コミュニティ/視察会 |
| 通知方法 | メール＋アプリ内（ベルアイコン＋バッジ＋一覧ページ） |
| リマインドメール | 自動送信（日数は管理者設定可）、対象選択可、テンプレ＋カスタマイズ可 |

### 権限・表示
| 項目 | 仕様 |
|------|------|
| スタンダードの制限機能表示 | 鍵アイコン＋「エキスパートで利用可能」＋アップグレードボタン |
| 一般メンバー | 管理者メニュー非表示、ダッシュボードは後日修正 |

### スコープ
| 今回実装 | 後回し |
|----------|--------|
| リマインドメール送信 | ログイン履歴の国・地域表示 |
| 組織設定の変更履歴 | 一般メンバー用ダッシュボード修正 |
| 通知設定・通知一覧ページ | |

---

## 共通基盤タスク

### A. 通知システム（新規）
| # | タスク | 詳細 |
|---|--------|------|
| A-1 | Notificationモデル作成 | type, title, body, read, userId, createdAt, link |
| A-2 | NotificationPreferenceモデル | 種類別ON/OFF（メール/アプリ内） |
| A-3 | ベルアイコンコンポーネント | ヘッダー配置、未読バッジ |
| A-4 | 通知一覧ページ | `/notifications` 一覧・既読処理・全既読 |
| A-5 | 通知作成API | POST /api/notifications |
| A-6 | メール送信連携 | 設定に応じて自動メール |
| A-7 | 通知設定ページ | 種類別ON/OFF切り替えUI |

### B. リマインドメール（新規）
| # | タスク | 詳細 |
|---|--------|------|
| B-1 | ReminderSettingモデル | daysThreshold（管理者設定可）, enabled, targetType |
| B-2 | EmailTemplateモデル拡張 | REMINDER用テンプレート追加 |
| B-3 | テンプレートカスタマイズUI | 管理者が文面編集可能 |
| B-4 | 自動送信バッチ | cron: 未ログイン者検出＆送信 |
| B-5 | ReminderLogモデル | 送信履歴記録 |
| B-6 | 送信履歴表示UI | メンバー管理画面から確認可能 |

### C. Stripe連携（新規）
| # | タスク | 詳細 |
|---|--------|------|
| C-1 | Stripe初期設定 | 環境変数、SDK導入 |
| C-2 | 商品/価格マスタ | 視察会、懇親会、資格追加受講 |
| C-3 | Checkout Session API | POST /api/stripe/checkout |
| C-4 | Webhook受信エンドポイント | POST /api/stripe/webhook |
| C-5 | Paymentモデル | 決済履歴保存 |
| C-6 | 請求履歴表示 | Stripe Invoice連携 |

### D. 左ナビ再構成
| # | タスク | 詳細 |
|---|--------|------|
| D-1 | ナビ構造変更 | 利用/管理者メニュー分離 |
| D-2 | 区切り線・太字スタイル | 管理者セクション強調 |
| D-3 | 権限別表示制御 | role判定でメニュー出し分け |
| D-4 | 「資格・研修」→「資格」 | ラベル変更 |
| D-5 | アクティブ状態強化 | 背景色変更 |

### E. プラン別表示制御
| # | タスク | 詳細 |
|---|--------|------|
| E-1 | ExpertOnlyBadge | 「エキスパート限定」バッジコンポーネント |
| E-2 | LockedFeatureCard | 鍵＋説明＋アップグレードボタン |
| E-3 | canAccess(feature) | プラン判定ユーティリティ |
| E-4 | UpgradeModal | アップグレード案内モーダル |

---

## 画面別タスク

### 1. ダッシュボード（10項目）
| # | タスク | 詳細 |
|---|--------|------|
| 1-1 | ヘッダープラン表記統一 | 「プレミア購読｜エキスパートプラン（管理者）」 |
| 1-2 | 管理者専用サマリー追加 | 招待人数/未ログイン/実績/更新日 |
| 1-3 | オンボーディング改善 | 「3分で社内利用を立ち上げる」タイトル、進捗(0/3) |
| 1-4 | 「スキップ」→「あとで設定」 | 常設リンク残す |
| 1-5 | KPIカード再設計 | 「2+」廃止→正確数字、管理者向け指標 |
| 1-6 | 鍵アイコン→ExpertOnlyBadge | コミュニティカード |
| 1-7 | 空状態文言改善 | CTA追加「おすすめアーカイブを見る」 |
| 1-8 | アーカイブにおすすめ理由追加 | 1行説明＋視聴ボタン |
| 1-9 | 管理者アクションエリア | 社員招待/メンバー管理/請求確認/サポート |
| 1-10 | エキスパート特典表示 | 上部固定「今月のおすすめ3点」 |

### 2. セミナー一覧（8項目）
| # | タスク | 詳細 |
|---|--------|------|
| 2-1 | 空状態を次行動型に | 文言＋CTA（人気アーカイブ/案内受取/リクエスト） |
| 2-2 | 次回開催予告エリア | 「調整中」「決まり次第お知らせ」＋通知ON導線 |
| 2-3 | カテゴリ件数バッジ | 0件はグレーアウト |
| 2-4 | 検索・並び替え追加 | 開催予定/過去切り替え、日順 |
| 2-5 | ページ役割定義 | 冒頭に説明文「このページでは〜」 |
| 2-6 | 管理者アクション | 「社員に共有」「案内メール送る」 |
| 2-7 | KPI実績表示 | 開催回数/参加者数/視聴回数 |
| 2-8 | 文言を能動型に | 「ありません」→「準備中です」 |

### 3. アーカイブ動画（8項目）
| # | タスク | 詳細 |
|---|--------|------|
| 3-1 | 価値訴求追加 | 「実務に直結する〜」見出し下 |
| 3-2 | 検索プレースホルダ改善 | 「例）営業/断熱/集客」＋人気キーワードチップ |
| 3-3 | 0件カテゴリグレーアウト | 件数多い順に並び替え |
| 3-4 | 動画カードに追加 | 対象者タグ、得られること1行 |
| 3-5 | サムネイルカテゴリ色分け | 営業=青、経営=緑、技術=オレンジ（色は要調整） |
| 3-6 | 次に見る導線 | 「あわせておすすめ」「人気」セクション |
| 3-7 | 管理者向け情報 | 「社員に共有」、視聴ランキング |
| 3-8 | KPI表示 | 本数/累計視聴/今月追加予定 |

### 4. オンラインコミュニティ（8項目）
| # | タスク | 詳細 |
|---|--------|------|
| 4-1 | 構造修正 | 「参加不可」→「利用するページ」 |
| 4-2 | 見出し変更 | 「エキスパート会員向け オンラインコミュニティ」 |
| 4-3 | 鍵アイコン条件分岐 | エキスパート=非表示、スタンダード=LockedFeatureCard |
| 4-4 | コミュニティ一覧表示 | 施工管理/人事・採用、説明/頻度/参加ボタン |
| 4-5 | ボタン差し替え | 「一覧を見る」「次回定例会確認」 |
| 4-6 | 説明文トーン変更 | エキスパート向け文言 |
| 4-7 | 管理者向け補足 | 「社員の参加状況〜」 |
| 4-8 | Zoomリンク表示 | ページ内＋メール通知連携 |

### 5. データブック（8項目）
| # | タスク | 詳細 |
|---|--------|------|
| 5-1 | 鍵/アップグレード削除 | エキスパートでは非表示 |
| 5-2 | 見出し変更 | 「データブック（エキスパート会員向け）」 |
| 5-3 | 一覧カード表示 | サムネ/タイトル/発行年月/説明/DLボタン |
| 5-4 | 表紙画像アップロード | 管理画面から登録 |
| 5-5 | 年次区切り表示 | 「2026年版（全4冊）」発行済/準備中 |
| 5-6 | 次回発行予定表示 | 「2026年7月公開予定」 |
| 5-7 | DL制限ロジック | 契約期間内（開始〜更新日）発行分のみ |
| 5-8 | スタンダード表示 | LockedFeatureCard |

### 6. ニュースレター（8項目）
| # | タスク | 詳細 |
|---|--------|------|
| 6-1 | 鍵/アップグレード削除 | エキスパートでは非表示 |
| 6-2 | 説明文修正 | 「毎月お届け〜いつでも閲覧」 |
| 6-3 | アーカイブ一覧表示 | 発行年月/タイトル/概要/読むボタン |
| 6-4 | NEWラベル | 最新号に付与 |
| 6-5 | メール配信説明追加 | 「※登録メールにも配信」 |
| 6-6 | 年別フィルター | 将来拡張用 |
| 6-7 | PDF閲覧/DL | クリックで表示 |
| 6-8 | スタンダード表示 | LockedFeatureCard |

### 7. 視察会（9項目）
| # | タスク | 詳細 |
|---|--------|------|
| 7-1 | タイトル変更 | 「視察会（現地見学イベント）」 |
| 7-2 | 空状態改善 | 「準備中です」＋通知ON＋詳細リンク |
| 7-3 | 視察会カードUI | 企業名/日付/場所/定員/残席/条件 |
| 7-4 | プラン別料金表示 | エキスパート=無料2名、スタンダード=20,000円/人 |
| 7-5 | 懇親会オプション | チェックボックス＋別料金（5,000〜6,000円） |
| 7-6 | Stripe決済連携 | 人数選択→金額反映→Checkout |
| 7-7 | 定員管理 | 1社2名上限、残席表示、満席時ボタン非表示 |
| 7-8 | 管理者情報 | 申込社数/人数/無料枠使用状況 |
| 7-9 | 過去視察会アーカイブ | 実績セクション |

### 8. ツール（7項目）
| # | タスク | 詳細 |
|---|--------|------|
| 8-1 | 説明ブロック追加 | 「順次公開、準備中含む」 |
| 8-2 | 状態ラベル表示 | 利用可能/準備中/近日公開/エキスパート限定 |
| 8-3 | 準備中グレーアウト | ＋ポジティブ説明 |
| 8-4 | カテゴリ1行説明 | チェックリスト/テンプレート/計算/診断 |
| 8-5 | ファイル形式表示 | Excel/Word/PDF明示 |
| 8-6 | ロードマップエリア | 今後追加予定 |
| 8-7 | 内部フラグ設計 | 公開/準備中/プラン制限 |

### 9. 資格（10項目）
| # | タスク | 詳細 |
|---|--------|------|
| 9-1 | タイトル変更 | 「資格｜全国住宅リフォーム取扱主任者（2級）認定講座」 |
| 9-2 | 空状態廃止 | 資格カード常設 |
| 9-3 | 資格カードUI | 名称/対象者/価格/無料枠状況 |
| 9-4 | 無料枠ステータス表示 | 「1/1名（未使用）」緑、「0/1（使用済）」グレー |
| 9-5 | 受講フローボタン | 無料枠登録/追加受講(15,000円)/状況確認 |
| 9-6 | リセット日表示 | 「次回：契約更新日」 |
| 9-7 | 「研修」ワード削除 | 全箇所 |
| 9-8 | センリョクメール連携 | 申込時自動送信（組織名/申込者/人数） |
| 9-9 | 修了者一覧 | 過去実績セクション |
| 9-10 | ナビ変更 | 「資格・研修」→「資格」 |

### 10. メンバー管理（9項目）
| # | タスク | 詳細 |
|---|--------|------|
| 10-1 | 上部サマリー変更 | 登録数/上限、利用中、未利用（要フォロー） |
| 10-2 | 招待ボタン補足 | 「社内メンバーのみ」＋権限選択 |
| 10-3 | メンバー行追加表示 | 最終利用日/利用カテゴリ/ステータスラベル |
| 10-4 | 「利用状況」→「利用詳細を見る」 | クリック先：参加/視聴/DL履歴 |
| 10-5 | 管理者ラベル | 「👑管理者」固定表示 |
| 10-6 | 「あなた」行強調 | 背景色＋説明 |
| 10-7 | 検索・フィルタ・並び替え | 名前/メール、役割/利用状況、日順 |
| 10-8 | リマインドCTA | 「📩利用を促す」ボタン |
| 10-9 | 拡張用フラグ | lastActivityAt, enabledFeatures等 |

### 11. 組織設定（9項目）
| # | タスク | 詳細 |
|---|--------|------|
| 11-1 | 重要性警告 | ページ上部に注意文（黄背景） |
| 11-2 | 編集ボタン説明追加 | 「組織名・メール・住所を変更」 |
| 11-3 | ドメイン自動参加スイッチ化 | ON/OFF＋警告強化＋確認モーダル |
| 11-4 | ドメイン追加影響説明 | ＋履歴表示（追加日/追加者） |
| 11-5 | 統計表示変更 | 「48名（招待50名）残り2名」＋残りメンバー確認 |
| 11-6 | プラン詳細表示 | 「エキスパートコース/更新月」 |
| 11-7 | ロゴ用途説明 | 「ダッシュボード・資料・コミュニティに表示」 |
| 11-8 | 危険ゾーン強化 | 影響説明＋組織名入力必須の二段階削除 |
| 11-9 | 変更履歴エリア | 組織情報/ドメイン変更ログ |

### 12. 請求・支払い（9項目）
| # | タスク | 詳細 |
|---|--------|------|
| 12-1 | 説明文変更 | 「契約内容・支払状況・請求履歴を確認」 |
| 12-2 | 空状態3ブロック | 状態/補足/行動導線 |
| 12-3 | ボタン変更 | 「契約手続きへ」＋注意文 |
| 12-4 | 外部決済明示 | 「安全な決済サービスを利用」 |
| 12-5 | 契約情報プレースホルダ | プラン/状況/開始日/更新日/支払方法 |
| 12-6 | 請求履歴セクション | Stripe連携：日付/金額/ステータス/領収書 |
| 12-7 | 管理者限定明示 | 「※管理者のみ利用可能」 |
| 12-8 | 問い合わせ導線 | 契約/請求メールリンク |
| 12-9 | レイアウト最適化 | 空白削減、幅調整 |

### 13. セキュリティ設定（9項目）
| # | タスク | 詳細 |
|---|--------|------|
| 13-1 | 警告文追加 | 「管理者以外操作禁止」黄背景 |
| 13-2 | パスワード条件明示 | 8文字/英大小/数字/記号推奨＋強度表示 |
| 13-3 | 成功メッセージ | 「変更しました。再ログインしてください」 |
| 13-4 | 2FA見出し強化 | 「【強く推奨】」＋有効(緑)/無効(赤) |
| 13-5 | 認証アプリ説明 | 「スマホに〜6桁コード入力」 |
| 13-6 | セッション管理改善 | 「ログイン中の端末」＋全ログアウト機能 |
| 13-7 | ログイン履歴詳細 | 端末種別/成功失敗アイコン |
| 13-8 | サポート導線 | 「不審な操作は連絡」固定リンク |
| 13-9 | メニュー強調 | アイコン赤色等 |

### 14. 設定（8項目）
| # | タスク | 詳細 |
|---|--------|------|
| 14-1 | タイトル変更 | 「アカウント・組織設定」 |
| 14-2 | セクション分離 | 「あなた個人」「組織（管理者のみ）」 |
| 14-3 | 表示名説明 | 「社内・コミュニティ内で表示」 |
| 14-4 | メールアドレス説明 | 「変更はサポートへ」 |
| 14-5 | 権限説明追加 | 管理者の操作範囲明示 |
| 14-6 | プラン表示強化 | 更新日＋CTA「詳細を見る」 |
| 14-7 | 「アカウント操作」→「ログイン操作」 | |
| 14-8 | セキュリティ/通知導線 | リンク追加 |

---

## タスク数サマリー

| カテゴリ | タスク数 |
|----------|----------|
| A. 通知システム | 7 |
| B. リマインドメール | 6 |
| C. Stripe連携 | 6 |
| D. 左ナビ再構成 | 5 |
| E. プラン別表示制御 | 4 |
| **共通基盤 小計** | **28** |
| 1. ダッシュボード | 10 |
| 2. セミナー一覧 | 8 |
| 3. アーカイブ動画 | 8 |
| 4. コミュニティ | 8 |
| 5. データブック | 8 |
| 6. ニュースレター | 8 |
| 7. 視察会 | 9 |
| 8. ツール | 7 |
| 9. 資格 | 10 |
| 10. メンバー管理 | 9 |
| 11. 組織設定 | 9 |
| 12. 請求・支払い | 9 |
| 13. セキュリティ | 9 |
| 14. 設定 | 8 |
| **画面別 小計** | **120** |
| **総合計** | **148タスク** |

---

## DBスキーマ追加予定

### 新規テーブル
- Notification（通知）
- NotificationPreference（通知設定）
- ReminderSetting（リマインド設定）
- ReminderLog（リマインド送信履歴）
- Payment（決済履歴）
- OrganizationChangeLog（組織変更履歴）
- CommunityMeeting（コミュニティ定例会）
- StudyTourApplication（視察会申込）

### 既存テーブル拡張
- User: lastActivityAt追加
- Organization: reminderDaysThreshold追加
- QualificationEnrollment: 無料枠管理フィールド
